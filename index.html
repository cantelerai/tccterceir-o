<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AD Costeira - TCC</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Ícones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <style>
    body { scroll-behavior: smooth; }
    header h1 { font-weight: 700; }
    footer { font-size: .9rem; }
    .event-date{
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      width:70px;background:#0d6efd;color:#fff;border-radius:.5rem;margin-right:1rem
    }
    .event-date .day{font-size:1.4rem;font-weight:700;line-height:1}
    .event-date .month{text-transform:uppercase;font-size:.9rem;opacity:.9}
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="bg-primary text-white py-3">
    <div class="container d-flex justify-content-between align-items-center">
      <h1>AD Costeira</h1>
      <nav>
        <a href="#about" class="text-white mx-2">Sobre</a>
        <a href="#events" class="text-white mx-2">Eventos</a>
        <a href="#inscricao" class="text-white mx-2">Inscrição</a>
        <a href="#contact" class="text-white mx-2">Contato</a>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section id="hero" class="text-center py-5 bg-light">
    <div class="container">
      <h1 id="hero-title" class="display-4">Carregando Título...</h1>
      <p class="lead" id="hero-sub">Lugar de gente feliz.</p>
    </div>
  </section>

  <!-- SOBRE -->
  <section id="about" class="py-5">
    <div class="container">
      <h2 id="about-title" class="text-center mb-4">Carregando Título...</h2>
      <div class="row">
        <div class="col-md-8 mx-auto">
          <p id="about-text-1">Carregando texto de apresentação...</p>
          <p id="about-text-2">Carregando texto adicional 1...</p>
          <p id="about-text-3">Carregando texto adicional 2...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- EVENTOS -->
  <section id="events" class="py-5 bg-light">
    <div class="container">
      <h2 class="text-center mb-5" id="events-title">Próximos Eventos Comunitários</h2>
      <div class="row g-4" id="events-list-container">
        <p class="text-center text-muted">Aguarde, carregando eventos do banco de dados...</p>
      </div>
    </div>
  </section>

  <!-- INSCRIÇÃO -->
  <section id="inscricao" class="py-5">
    <div class="container">
      <h3 class="text-center mb-4">Faça sua Inscrição em um Evento</h3>
      <form id="inscricao-form" class="p-4 border rounded shadow-sm">
        <input type="hidden" id="event-id-input" name="event_id" required>

        <div class="alert alert-info" role="alert" id="evento-selecionado-display">
          Para se inscrever, clique primeiro no botão "Quero me inscrever" em um evento na lista.
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="nome-inscrito" class="form-label">Seu Nome Completo</label>
            <input type="text" class="form-control" id="nome-inscrito" required>
          </div>
          <div class="col-md-6 mb-3">
            <label for="email-inscrito" class="form-label">Seu Email</label>
            <input type="email" class="form-control" id="email-inscrito" required>
          </div>
        </div>

        <button type="submit" class="btn btn-success btn-lg w-100 mt-3">Confirmar Inscrição</button>
        <div id="form-message" class="mt-3 text-center"></div>
      </form>
    </div>
  </section>

  <!-- CONTATO -->
  <section id="contact" class="py-5 bg-dark text-white">
    <div class="container text-center">
      <h2 id="contact-title">Contato e Horários</h2>
      <p>Telefone: <span id="contact-phone">Carregando...</span></p>
      <h4 class="mt-4">Horário de Cultos</h4>
      <div id="service-times-list">Carregando horários...</div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="bg-secondary text-white py-3">
    <div class="container text-center">
      <p id="footer-address">Carregando endereço...</p>
      <p>&copy; 2025 AD Costeira. TCC Terceirão.</p>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Supabase (ESM) + Lógica -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    // ==== SUPABASE ====
    const SUPABASE_URL = "https://xskasveyyprxuuilkavit.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhza2FzdnNleXB2eHV1bGtldmlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgyOTEyODgsImV4cCI6MjA3Mzg2NzI4OH0.QMJOGkErNQPhW0ZnRKc6fC5f7Wxze68GnW7hf9lmMXo";
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    console.log("✅ Supabase conectado");

    const $ = (s) => document.querySelector(s);
    const setText = (id, val) => { const el = document.getElementById(id); if (el && val != null) el.textContent = val; };
    const html = (strings, ...vals) => strings.map((s,i)=>s+(vals[i]??"")).join("");

    // Meses pt-BR -> índice p/ ordenação
    const PT_MONTH_INDEX = { jan:0, fev:1, mar:2, abr:3, mai:4, jun:5, jul:6, ago:7, set:8, out:9, nov:10, dez:11 };
    const monthToIndex = (m) => m ? PT_MONTH_INDEX[m.trim().t]()
